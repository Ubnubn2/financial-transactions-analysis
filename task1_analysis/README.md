# Задание 1: Анализ финансовых транзакций и клиентов

## Назначение

Проект выполняет очистку и анализ данных о финансовых транзакциях, объединяет их с данными клиентов и проводит сегментацию по уровню активов. Результаты представлены в Jupyter Notebook с визуализациями и выводами.

## Структура папки `task1_analysis`
```task1_analysis/
├── notebooks/               # Jupyter Notebook и все сгенерированные графики
│   ├── main.md              # Ноутбук в формате Markdown (экспортированный)
│   └── output_*.png          # Изображения, встроенные в ноутбук
├── src/                      # (опционально) исходный код, если выносится из ноутбука
│   └── main.py               # Пример скрипта (если есть)
├── data/                      # (создаётся после запуска) очищенные данные
│   ├── transactions_cleaned.csv
│   └── transactions_cleaned.xlsx
├── requirements.txt           # Зависимости Python
└── README.md                  # Этот файл
```

## Установка и запуск

1. **Клонируйте репозиторий** и перейдите в папку задания:
   ```bash
   cd task1_analysis
   ```

2. **Установите зависимости**:
   ```bash
   pip install -r requirements.txt
   ```
   Основные библиотеки: `pandas`, `numpy`, `openpyxl`, `matplotlib`, `seaborn`, `scikit-learn`, `jupyter`.

3. **Запустите Jupyter Notebook**:
   ```bash
   jupyter notebook notebooks/main.md
   ```
   (Если файл имеет расширение `.md`, его можно открыть как обычный Markdown-документ; для полноценного запуска кода лучше использовать исходный `.ipynb` – при необходимости пересохраните его из HTML).

   Либо откройте ноутбук через интерфейс Jupyter, выбрав файл `main.md` или `main.ipynb`.

4. **Выполните все ячейки последовательно**. Будут созданы очищенные файлы `transactions_cleaned.csv` и `transactions_cleaned.xlsx` в папке `data/` (или рядом с ноутбуком).

## Результаты анализа

Подробный анализ с графиками и выводами представлен в ноутбуке `notebooks/main.md`. Ниже приведены ключевые итоги.

### 1. Очистка данных
- Исходный файл `transactions_data.xlsx` содержал пропуски и текстовые маркеры (`INVALID_DATE`, «Неизвестная услуга» и т.п.), которые заменены на `NaN`.
- Удалены строки с некорректными датами, отрицательными суммами, пропущенными `client_id`.
- Категориальные пропуски заполнены значением `'unknown'`.
- Итоговый чистый DataFrame: **8411 строк** (из исходных 10000).

### 2. Анализ данных
- **Топ-5 услуг по количеству заказов**:
  1. Инвестиционное консультирование – 2085
  2. Управление активами – 1729
  3. Налоговое планирование – 1316
  4. Финансовое планирование – 1315
  5. Структурирование капитала – 1287
- **Средняя сумма по городам** варьируется от ~58 000 до ~42 000. Город `unknown` (пропуски) имеет среднюю 48 664 – в пределах общего диапазона.
- **Услуга с наибольшей выручкой** – «Инвестиционное консультирование» (104,2 млн).
- **Способы оплаты**:
  - Кредитная карта – 39,9%
  - Банковский перевод – 34,6%
  - `unknown` – 10,3%
  - Наличные – 9,9%
  - Криптовалюта – 5,3%
  *Преобладают безналичные платежи.*
- **Выручка за последний месяц**:
  - За последние 30 дней (с 2025-02-18 по 2025-03-20) – **161,5 млн**.
  - За полный март (по 20 марта) – **105,3 млн** (март неполный, поэтому сумма меньше).

### 3. Объединение с клиентскими данными и сегментация по капиталу
- После объединения с `clients_data.json` (очищен от пропусков в `id`) получено **8411 записей** (inner join).
- **Распределение клиентов по уровням капитала**:
  - Низкий (<100k): **152** клиента
  - Средний (100k–1M): **1397** клиентов
  - Высокий (>1M): **6448** клиентов
- **Выручка по уровням капитала**:
  - Низкий капитал: **7,20 млн**
  - Средний капитал: **67,98 млн**
  - Высокий капитал: **319,28 млн**
  *Наибольшую выручку приносят клиенты среднего достатка.*

### 4. Визуализация
Построены:
- гистограмма распределения сумм транзакций,
- столбчатые диаграммы выручки по услугам,
- круговая диаграмма способов оплаты,
- график зависимости средней суммы от возраста.
Все графики доступны в ноутбуке.

### 5. Прогнозирование спроса на следующий месяц
- Модель: линейная регрессия на ежедневных данных (количество транзакций).
- Средняя абсолютная ошибка на тестовой выборке (последние 7 дней) – **13,8** транзакций (при среднем фактическом значении 91,43).
- Прогноз на апрель 2025: около **105** транзакций в день – небольшой рост спроса.

## Выводы

Выполнен полный цикл анализа данных: от очистки до прогнозирования. Выявлены ключевые услуги, структура платежей, портрет клиента по капиталу. Полученные результаты могут быть использованы для планирования маркетинговых активностей и оптимизации продуктовой линейки.

## Примечания
- Все сгенерированные файлы данных (`*.csv`, `*.xlsx`) добавлены в `.gitignore` и не хранятся в репозитории (при необходимости их можно воспроизвести запуском ноутбука).
- Ноутбук и все изображения находятся в папке `notebook/`.
